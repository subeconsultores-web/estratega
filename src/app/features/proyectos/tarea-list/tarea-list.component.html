<div class="space-y-6 relative min-h-[50vh] animate-in fade-in duration-300">

    <div class="flex justify-between items-center mb-4">
        <div>
            <h2 class="text-xl font-bold text-slate-900 dark:text-white">Lista de Tareas</h2>
            <p class="text-sm text-slate-500 dark:text-slate-400">Visión condensada de todas las actividades</p>
        </div>

        <button (click)="abrirModalNuevaTarea()"
            class="relative group px-4 py-2 rounded-xl font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 transition-all duration-300 shadow-md shadow-blue-500/20 hover:shadow-blue-500/40 flex items-center gap-2 overflow-hidden">
            <div
                class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300 ease-in-out">
            </div>
            <lucide-icon name="plus" class="w-4 h-4 relative z-10"></lucide-icon>
            <span class="relative z-10 text-sm">Añadir Tarea</span>
        </button>
    </div>

    <ng-container *ngIf="tareas$ | async as tareas; else loading">

        <!-- Tabla de Datos Compartida -->
        <app-data-table *ngIf="tareas.length > 0; else empty" [data]="tareas" [columns]="columns"
            (actionClick)="onActionClick($event)">
        </app-data-table>

        <ng-template #empty>
            <div
                class="bg-slate-50/50 dark:bg-slate-900/30 rounded-2xl border border-slate-200/60 dark:border-slate-800/60 p-12 text-center flex flex-col items-center">
                <div
                    class="w-16 h-16 bg-blue-100 dark:bg-slate-800 text-blue-500 dark:text-slate-400 rounded-2xl flex justify-center items-center mb-4">
                    <lucide-icon name="clipboard-list" class="w-8 h-8"></lucide-icon>
                </div>
                <h3 class="text-lg font-bold text-slate-800 dark:text-white mb-2">Sin tareas ingresadas</h3>
                <p class="text-slate-500 text-sm mb-6 max-w-sm">Este proyecto aún no tiene ninguna tarea asociada a un
                    flujo de trabajo.</p>
                <button (click)="abrirModalNuevaTarea()"
                    class="px-5 py-2 hover:bg-slate-200 dark:hover:bg-slate-700 bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-700 text-slate-700 dark:text-slate-300 font-medium rounded-xl text-sm transition-colors">
                    Crear Tarea Manual
                </button>
            </div>
        </ng-template>
    </ng-container>

    <ng-template #loading>
        <app-loading-skeleton></app-loading-skeleton>
    </ng-template>

    <!-- Modal Reutilizable de Tarea -->
    <app-tarea-form *ngIf="showTareaModal" [tareaSeleccionada]="tareaEnEdicion" (onSave)="guardarTarea($event)"
        (onCancel)="cerrarModalTarea()">
    </app-tarea-form>
</div>